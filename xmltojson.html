<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Convertir Excel (XLSX) a JSON</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body style="font-family: sans-serif;">
  <h2>Convertidor de Excel a JSON</h2>
  <input type="file" id="excelFile" accept=".xlsx" />
  <button onclick="convertirExcel()">Convertir y Descargar JSON</button>

  <script>
    function convertirExcel() {
      const input = document.getElementById("excelFile");
      if (!input.files.length) {
        alert("Seleccion√° un archivo Excel (.xlsx).");
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });

        // Tomar solo la primera hoja
        const primeraHoja = workbook.SheetNames[0];
        const hoja = workbook.Sheets[primeraHoja];

        // Convertir a JSON
        const json = XLSX.utils.sheet_to_json(hoja);

        // Descargar JSON
        const blob = new Blob([JSON.stringify(json, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "empresas.json";
        a.click();
        URL.revokeObjectURL(url);
      };

      reader.readAsArrayBuffer(input.files[0]);
    }
  </script>
</body>
</html>
